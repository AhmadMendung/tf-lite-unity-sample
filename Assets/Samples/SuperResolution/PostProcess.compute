#pragma kernel TensorToTexture

StructuredBuffer<float3> _InputTensor;
RWTexture2D<float4> _OutputTex;

uint2 _InputSize;

[numthreads(8,8,1)]
void TensorToTexture (uint2 tid : SV_DispatchThreadID)
{
    uint gid = (_InputSize.y - 1 - tid.y) * _InputSize.x + tid.x;
    float3 rgb = _InputTensor[gid] / 255.0;
    _OutputTex[tid] = saturate(float4(rgb.rgb, 1.0));
}
